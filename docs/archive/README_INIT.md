# 🚀 Rumah Plagiasi - Complete Setup

Modern document bypass system dengan Next.js frontend dan Python FastAPI backend. **One-command initialization!**

⚡ **Created by devnolife**

---

## ⚡ Quick Start (Recommended)

The **fastest** way to get started:

```bash
# Clone or navigate to project
cd vision-computer

# Run ONE command to setup everything
./init.sh

# Start backend
./start_production.sh

# Start frontend (in new terminal)
cd frontend && npm run dev

# Access: http://localhost:3000
```

**That's it!** 🎉 Everything is configured automatically including:
- ✅ Secure API key generation
- ✅ Backend `.env` configuration
- ✅ Frontend `.env` configuration
- ✅ All dependencies installed
- ✅ Database setup (Prisma)
- ✅ Directory structure created

---

## 📖 Detailed Documentation

For detailed setup and usage, see:

- **[QUICK_START.md](QUICK_START.md)** - Complete quick start guide
- **[API_KEY_SETUP.md](API_KEY_SETUP.md)** - API key authentication
- **[frontend/README.md](frontend/README.md)** - Frontend documentation

---

## 🎯 What Does init.sh Do?

The initialization script automates the entire setup process:

### 1. Prerequisites Check
- Verifies Python 3.8+
- Verifies Node.js 18+
- Verifies npm
- Checks for Redis (optional)
- Checks for PostgreSQL (optional)

### 2. Security Setup
- Generates cryptographically secure API key (64 characters)
- Creates backend `.env` with API_KEY
- Creates frontend `.env` with PYTHON_API_KEY (same key)
- Ensures both apps can communicate securely

### 3. Dependency Installation
- Installs Python packages from requirements.txt
- Installs Node.js packages from frontend/package.json
- Sets up Prisma Client

### 4. Database Setup
- Generates Prisma Client
- Pushes database schema
- Creates necessary tables

### 5. Directory Structure
- Creates `uploads/` for uploaded files
- Creates `outputs/` for processed files
- Creates `temp/` for temporary files
- Creates `logs/` for application logs
- Creates `pids/` for process IDs

### 6. Verification
- Validates all configurations
- Checks API key consistency
- Verifies directory structure
- Displays comprehensive summary

---

## 🏗️ Architecture

```
┌─────────────────────────────────────────────────────────┐
│                   init.sh (One Command)                  │
│                                                          │
│  1. Check Prerequisites                                  │
│  2. Generate API Key: apk_abc123...                      │
│  3. Setup Backend .env with API_KEY                      │
│  4. Setup Frontend .env with PYTHON_API_KEY (same key)   │
│  5. Install Python dependencies                          │
│  6. Install Node.js dependencies                         │
│  7. Setup Prisma database                                │
│  8. Create directories                                   │
│  9. Verify everything                                    │
│                                                          │
└─────────────────────────────────────────────────────────┘
                            ↓
        ┌───────────────────┴────────────────────┐
        │                                        │
        ↓                                        ↓
┌───────────────────┐                  ┌────────────────────┐
│ Backend (Port 8000)│                 │ Frontend (Port 3000)│
│                   │                  │                     │
│ .env:             │                  │ .env:               │
│   API_KEY=apk_... │◄─────────────────┤   PYTHON_API_KEY=   │
│                   │   Same API Key   │     apk_...         │
│ FastAPI + Celery  │                  │ Next.js + Prisma    │
└───────────────────┘                  └────────────────────┘
```

---

## 📁 Project Structure

```
vision-computer/
├── init.sh                    # 🔥 ONE-COMMAND SETUP SCRIPT
├── generate_api_key.py        # API key generator
├── start_production.sh        # Start backend services
├── stop_production.sh         # Stop backend services
├── restart_production.sh      # Restart backend services
├── status_production.sh       # Check service status
├── pm2-like.sh                # PM2-like manager
│
├── .env                       # ✅ Auto-generated by init.sh
├── .env.example               # Environment template
│
├── app/                       # Python FastAPI application
│   ├── main.py                # FastAPI app
│   ├── middleware/            # API key middleware
│   ├── bypass_engine.py       # Bypass processing
│   ├── content_analyzer.py    # Document analysis
│   └── tasks.py               # Celery tasks
│
├── uploads/                   # ✅ Auto-created by init.sh
├── outputs/                   # ✅ Auto-created by init.sh
├── temp/                      # ✅ Auto-created by init.sh
├── logs/                      # ✅ Auto-created by init.sh
├── pids/                      # ✅ Auto-created by init.sh
│
└── frontend/                  # Next.js application
    ├── .env                   # ✅ Auto-generated by init.sh
    ├── package.json           # Node dependencies
    ├── prisma/
    │   └── schema.prisma      # Database schema
    ├── app/                   # Next.js App Router
    ├── components/            # React components
    └── lib/
        ├── prisma.ts          # Prisma client
        └── api/
            └── python-client.ts # Python API integration
```

---

## 🔐 API Key Authentication

After running `init.sh`, both backend and frontend will have the **same API key** configured automatically:

### Backend (.env)
```env
API_KEY=apk_GeneratedKey123...
```

### Frontend (frontend/.env)
```env
PYTHON_API_KEY=apk_GeneratedKey123...
```

This ensures secure communication between Next.js and Python API. All requests require the `X-API-Key` header.

For more details, see [API_KEY_SETUP.md](API_KEY_SETUP.md)

---

## 🎬 Usage Examples

### Initialize Project
```bash
./init.sh
```

### Start Services
```bash
# Option 1: Production mode
./start_production.sh

# Option 2: PM2-like manager
./pm2-like.sh start

# Option 3: Development mode
uvicorn app.main:app --reload
```

### Check Status
```bash
./status_production.sh
# or
./pm2-like.sh status
```

### View Logs
```bash
./pm2-like.sh logs
# or
tail -f logs/*.log
```

### Stop Services
```bash
./stop_production.sh
# or
./pm2-like.sh stop
```

### Restart Services
```bash
./restart_production.sh
# or
./pm2-like.sh restart
```

---

## 🧪 Testing

### Test Backend Health
```bash
curl http://localhost:8000/health
```

### Test API with Authentication
```bash
# Get API key from .env
API_KEY=$(grep "^API_KEY=" .env | cut -d'=' -f2)

# Test authenticated endpoint
curl http://localhost:8000/config/strategies \
  -H "X-API-Key: $API_KEY"
```

### Test Frontend
```bash
# Open browser
open http://localhost:3000
```

---

## 🔧 Manual Setup (Alternative)

If you prefer manual setup instead of using `init.sh`:

### 1. Generate API Key
```bash
python generate_api_key.py
```

### 2. Configure Backend
```bash
cp .env.example .env
# Edit .env and add API_KEY
```

### 3. Configure Frontend
```bash
cd frontend
cp .env.example .env
# Edit .env and add PYTHON_API_KEY (same as backend API_KEY)
```

### 4. Install Dependencies
```bash
# Backend
pip install -r requirements.txt

# Frontend
cd frontend
npm install
```

### 5. Setup Database
```bash
cd frontend
npx prisma generate
npx prisma db push
```

### 6. Create Directories
```bash
mkdir -p uploads outputs temp logs pids
```

---

## 📊 Features

### Backend (Python FastAPI)
- ✅ Document bypass processing (multiple strategies)
- ✅ Document analysis & flag detection
- ✅ OCR processing for PDFs
- ✅ Celery task queue for async processing
- ✅ Redis for caching and message broker
- ✅ API key authentication
- ✅ Swagger/ReDoc documentation

### Frontend (Next.js)
- ✅ Modern UI with Shadcn components
- ✅ Prisma ORM for database
- ✅ NextAuth.js for authentication
- ✅ User management
- ✅ Document management
- ✅ Bypass history & analytics
- ✅ Real-time progress tracking
- ✅ Python API integration

---

## 🚀 Deployment

### Development
```bash
./init.sh
./start_production.sh
cd frontend && npm run dev
```

### Production
1. Run `init.sh` with production settings
2. Setup reverse proxy (Nginx)
3. Use PM2 for process management
4. Setup SSL certificates
5. Configure production database
6. Enable monitoring & logging

---

## 🐛 Troubleshooting

See [QUICK_START.md](QUICK_START.md#troubleshooting) for common issues and solutions.

---

## 📚 Documentation

- **[QUICK_START.md](QUICK_START.md)** - Complete setup guide
- **[API_KEY_SETUP.md](API_KEY_SETUP.md)** - API authentication
- **[frontend/README.md](frontend/README.md)** - Frontend documentation
- **API Docs** - http://localhost:8000/docs (after starting backend)

---

## 🤝 Contributing

1. Fork the repository
2. Create feature branch
3. Implement feature with tests
4. Run linter and tests
5. Submit pull request

---

## 📄 License

Private - Created by devnolife

---

## 💡 Support

For questions or issues:
- Read documentation
- Check troubleshooting guide
- Open an issue

---

⚡ **Made with ❤️ by devnolife**

**Remember:** Just run `./init.sh` and you're ready to go! 🚀
